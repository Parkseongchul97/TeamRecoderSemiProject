<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.MembershipMapper">



<resultMap type="MembershipUserList" id="membershipmap">
<id column = "list_code" property="listCode"/>
<result column="list_grade" property="listGrade"/>
<association property="member" javaType="Member">
<id column ="id" property="id"/>
<result column="name" property="name"/>
<result column="nickname" property="nickname"/>
<result column="member_img" property="memberImg"/>
</association>
<association property="membership" javaType="Membership">
<id column="membership_code" property="membershipCode"/>
 <result column="Membership_name" property="membershipName"/>
 <result column="Membership_img" property="membershipImg"/>
 <result column="Membership_info" property="membershipInfo"/>
 <result column="Mebership_date"  property="membershipDate"/>
 <result column="Membership_grade" property="membershipGrade"/>
 <result column="Membership_max" property="membershipMax"/>
</association>
</resultMap>

<select id="allMembership" resultMap="membershipmap">
SELECT *
FROM membership_user_list
JOIN membership USING (membership_code)
JOIN member USING (id)
WHERE list_grade = "host";
</select>









<select id="main" parameterType="Integer"  resultMap="membershipmap">
SELECT *
FROM membership_user_list
JOIN membership USING (membership_code)
JOIN member USING (id)
WHERE membership_code = "${memebershipCode}" AND list_grade = "host" ;
</select>


<select id="count" parameterType="Integer" resultType="Integer">
SELECT count(*) as count
FROM membership_user_list
WHERE membership_code= #{i}
GROUP BY membership_code;
</select>

<insert id="makeMembership" parameterType="Membership">
INSERT INTO membership(membership_name,membership_img,membership_info,membership_max) 
VALUES(#{membershipName},#{membershipImg},#{membershipInfo},#{membershipMax})

</insert>

<insert id="host" parameterType="MembershipUserList">
INSERT INTO member_user_list (list_grade,id,membership_code) 
VALUES ("host",#{id},#{membershipCode})
</insert>








 </mapper>