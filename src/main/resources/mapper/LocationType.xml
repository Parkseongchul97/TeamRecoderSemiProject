<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.LocationTypeMapper">

	<!-- 5개 조인하기 -->
	<resultMap id="MembershipMap" type="Membership">
		<id column="membership_code" property="membershipCode"/> <!-- 프라이머리키 -->
		<result column="membership_name" property="membershipName"/>
		<result column="membership_img" property="membershipImg"/>
		<result column="membership_info" property="membershipInfo"/>
		<result column="membership_date" property="membershipDate"/>
		<result column="membership_grade" property="membershipGrade"/>
		<result column="membership_max" property="membershipMax"/>
		<association property="membershipLocation" javaType="MembershipLocation">
			<id column="mem_loc_code" property="memLocCode"/> <!-- 프라이머리키 -->
			<result column="loc_code" property="locSmallCode"/>
			<result column="membership_code" property="membershipCode"/>
			<association property="locationCategory" javaType="LocationCategory">
				<id column="loc_code" property="locCode"/> <!-- 프라이머리키 -->
				<result column="loc_la_name" property="locLaName"/>
				<result column="loc_s_name" property="locSName"/>
			</association>
		</association>
		<association property="membershipType" javaType="MembershipType">
			<id column="mem_type_code" property="memTypeCode"/> <!-- 프라이머리키 -->
			<result column="type_code" property="typeSmallCode"/>
			<result column="membership_code" property="membershipCode"/>
			<association property="typeCategory" javaType="TypeCategory">
				<id column="type_code" property="typeCode"/> <!-- 프라이머리키 -->
				<result column="type_la_name" property="typeLaName"/>
				<result column="type_s_name" property="typeSName"/>
			</association>
		</association>
	</resultMap>
	
	<!-- 대분류 위치 -->
	<select id="AllMembershipLocationLaname" resultMap="MembershipMap">
		SELECT loc_la_name FROM membership
		join membership_location USING(membership_code)
		join location_category USING(loc_code)
		join membership_type USING(membership_code)
		join type_category USING(type_code)
		group by loc_la_name; 
	</select>
	
	<!-- 소분류 위치 -->
	<select id="AllMembershipLocationSname" parameterType="String" resultMap="MembershipMap">
		SELECT loc_s_name FROM membership
		join membership_location USING(membership_code)
		join location_category USING(loc_code)
		join membership_type USING(membership_code)
		join type_category USING(type_code)
		where loc_la_name = #{locLaName};
	</select>

	<!-- 모든 위치 및 타입 가져오기 -->
	<select id="AllMembership" resultMap="MembershipMap">
		SELECT * FROM membership
		join membership_location USING(membership_code)
		join location_category USING(loc_code)
		join membership_type USING(membership_code)
		join type_category USING(type_code); 
	</select>
	
	<!-- 대분류 타입 가져오기 -->
	<select id="AllMembershipTypeLaname" resultMap="MembershipMap">
		SELECT type_la_name FROM membership
		join membership_location USING(membership_code)
		join location_category USING(loc_code)
		join membership_type USING(membership_code)
		join type_category USING(type_code)
		group by type_la_name;
	</select>
	
	<!-- 소분류 타입 가져오기 -->
	<select id="AllMembershipTypeSname" parameterType="String" resultMap="MembershipMap">
		SELECT type_s_name FROM membership
		join membership_location USING(membership_code)
		join location_category USING(loc_code)
		join membership_type USING(membership_code)
		join type_category USING(type_code)
		where type_la_name = #{typeLaName}
		group by type_s_name;
	</select>
	

</mapper>